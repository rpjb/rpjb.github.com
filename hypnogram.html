<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 15px sans-serif;
}

</style>
<body>
<script src="d3.v3.min.js"></script>
<div>
basic hypnogram
</div>
<div id="viz"></div>



<script>
// load json data
var data; // global holder for data
d3.json("second.json", function(json){
	data = json;
	makebars(data.sleepstage); // must execute data dependent graph here
});

// Create margin and sizes for plot
var margin = {top: 20, right: 20, bottom: 20, left: 75};
var width = 400;
var height = 100;

// Create y-axis settings
var yScale = d3.scale.linear()
    .domain([1,4]) // range of y-values
    .range([height-margin.bottom,margin.top]); // locations of y-values
var yAxis = d3.svg.axis()
    .scale(yScale)
	.ticks(4)
    .orient("left");

// make color
var color = d3.scale.linear().domain([1,4]).range(['gray','red']);

// Set the #viz div dimensions
var sampleSVG = d3.select("#viz")
    .append("svg")
    .attr("width", width+margin.left+margin.right)
    .attr("height", height+margin.top+margin.bottom);    

// Display y-axis
sampleSVG.append("g")
    .attr("class","axis")
    .attr("transform","translate(" + .5*margin.left + "," + 1.5*margin.top + ")")
    .append("g")
    .call(yAxis);

// Display labels for sleep
var sleeplabel = ["awake","light","REM","deep"];
var text = sampleSVG.selectAll("svg")
	.data(sleeplabel)
	.enter()
	.append("text");
	
var textLabels = text	
	.attr("x", 3*margin.left)
	.attr("y", function(d,i){return margin.top+height-yScale(0)+yScale(i)})
	.text(function(d){return d});
	

// Function to make the bars for graph
function makebars(dataset) {
    sampleSVG.selectAll("svg")
    .data(dataset)
    .enter().append("rect")
    .style("stroke", function(d){return color(d)})
    .attr("height", function(d,i){return yScale(0)-yScale(d)})
    .attr("width", 10)
    // x is from the left
    .attr("x", function(d,i){return margin.left+i*10})
    // y is from the top so you need to invert
    .attr("y", function(d,i){return margin.top+height-yScale(0)+yScale(d)})
	.style("fill",function(d){return color(d)});
}; 




</script>
</body>